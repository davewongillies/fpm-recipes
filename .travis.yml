---
dist: trusty
sudo: required
language: ruby
rvm: 1.9.3
cache: bundler
service:
  - docker
bundler_args: --without system_tests
matrix:
  fast_finish: true
  include:
stages:
  - build
  - cook
jobs:
  include:
    - stage: cook
      script: "bundle exec rake test:cook distro=$DISTRO"
      env: DISTRO=ubuntu-xenial
    - script: "bundle exec rake test:cook distro=$DISTRO"
      env: DISTRO=debian-jessie

    - stage: build
      script: "bundle exec rake test:build distro=$DISTRO"
      env: DISTRO=ubuntu-xenial
    - script: "bundle exec rake test:build distro=$DISTRO"
      env: DISTRO=debian-jessie
